select F.p1,G.id as p2,F.cnt as cnt from (select E.id as p1,D.a2 as personId,D.cnt as cnt from (select C.a1 personId,C.a2 a2,count(*) as cnt from (select A.a1,B.a2 from (SELECT ReviewId, AuthorId as a1 from comment where AuthorId is not NULL) A natural join (SELECT ReviewId, AuthorId as a2 from comment  where AuthorId is not NULL) B where A.a1<>B.a2)C group by C.a1,C.a2)D natural join personid E)F natural join personid G
