ElapsedTime (LastUpdatedOn minus CreatedOn)

SELECT EXTRACT(HOUR FROM timediff(`LastUpdatedOn`,`CreatedOn`))+EXTRACT(MINUTE FROM timediff(`LastUpdatedOn`,`CreatedOn`))/60 FROM `review` 

--------------------
Number of approvals
Net approval score (Sum of Approval.ReviewedStatus field)
Average approval score (Net approval score divided by number of approvals)



select A.ReviewId,B.cnt,B.total,B.net from review_with_id A left join (SELECT `ReviewId`,count(*) as cnt,sum(`ReviewedStatus`) as total,sum(`ReviewedStatus`)/count(*) as net FROM `approval` group by `ReviewId`)B on A.ReviewId=B.ReviewId
---------------------------
Number of comments
Date of first comment
Date of last comment
Comment span (Date of last comment minus Date of first comment)

select A.ReviewId,B.cnt,B.maxdate,B.mindate,B.diffdate from review_with_id A left join (SELECT `ReviewId`,count(*)as cnt,max(`WrittenOn`) as maxdate,min(`WrittenOn`) as mindate,EXTRACT(HOUR FROM TIMEDIFF(max(`WrittenOn`),min(`WrittenOn`)))+ EXTRACT(HOUR FROM       TIMEDIFF(max(`WrittenOn`),min(`WrittenOn`)))/60 as diffdate FROM `comment` group by ReviewId)B on A.ReviewId=B.ReviewId



----------------------------------
Number of total reviews owned by owner


select A.ReviewId ,A.OwnerId,B.cnt from review A natural join (SELECT `OwnerId`,count(*) as cnt FROM `review` group by `OwnerId`) B

Number of total approvals given by owner

select C.ReviewId,D.cnt from review C natural join (select A.OwnerId,B.cnt from (select distinct OwnerId from review) A left join (SELECT PersonId as OwnerId,count(*) as cnt FROM `approval` group by PersonId)B on A.OwnerId=B.OwnerId)D



----------------------------------------------------

Number of comments by owner on this review

select E.ReviewId,D.cnt from review E left join (select C.ReviewId,C.OwnerId ,count(*) as cnt from (select B.ReviewId,B.OwnerId from review A natural join (SELECT ReviewId,AuthorId as OwnerId FROM comment)B)C group by C.ReviewId,C.OwnerId) D on E.ReviewId=D.ReviewId
--------------------------------------------------------
Number of total comments by owner across all reviews


select E.reviewId,D.cnt from review E left join (select C.ReviewId,C.OwnerId,A.cnt from (SELECT `AuthorId` as OwnerId,count(*) as cnt  FROM `comment` group by AuthorId)A natural join review C)D on E.ReviewId=D.ReviewId
----------------------------------------------------------
Number of reviews of owner which have a status = "merged"


select E.ReviewId,D.cnt from review E left join (select A.ReviewId ,B.cnt from review A natural join (SELECT C.`OwnerId`,count(*) as cnt FROM (select * from `review` where status='merged')C group by `OwnerId`) B)D on D.ReviewId=E.ReviewId

-----------------------------------------------------------


select B.ReviewId,B.OwnerId,A.cnt from review B left join (SELECT distinct `PersonId` as OwnerId,sum(`ReviewedStatus`)/count(*) as cnt FROM `approval` group by `PersonId`)A on B.OwnerId=A.OwnerId

